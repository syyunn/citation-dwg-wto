\documentclass[12pt,letterpaper]{article}

\PassOptionsToPackage{hyphens}{url}


\usepackage{setspace}
\onehalfspacing

% === MARGINS ===
\addtolength{\hoffset}{-0.75in} 
\addtolength{\voffset}{-1.25in}
\addtolength{\textwidth}{1.5in} 
\addtolength{\textheight}{2.25in}

% == ENVS ==
\newenvironment{tightcenter}{%
  \setlength\topsep{0pt}
  \setlength\parskip{0pt}
  \begin{center}
}{
  \end{center}
}

% == PACKS ==
\usepackage{color,soul}
\usepackage{graphicx} % to use pngs in tex (include graphix)
\usepackage{calc} % To scale \pagewidth with \real{float}
\usepackage{pgfplots} % To draw histogram

\pgfplotsset{
  compat=1.17, 
colormap/viridis
} % request specific version of pgfplots

\usepackage{calc} % to use \real for text -> numeric
\usepackage{pgf} % to store numeric variables
\usepackage{subcaption} % to place two figures horizontally
\usepackage{caption} % to refer subfigure
\renewcommand{\thesubfigure}{(\alph{subfigure})}
\captionsetup[sub]{labelformat=simple}
\captionsetup[table]{font={stretch=1.2}}  % adjust line space in captions of TABLE and FIGURES
\captionsetup[figure]{font={stretch=1.2}}  


\usepackage{tikz}
\usetikzlibrary{automata,positioning}
\usetikzlibrary{arrows.meta, positioning, automata}
\usetikzlibrary{spy}
\usetikzlibrary{shadows}
\usetikzlibrary{arrows,positioning,shapes.geometric} % for dnn flowchart


\tikzset{
  font={\fontsize{10pt}{0}\selectfont}}
\usepackage{forest}
\tikzset{
  Decision/.style = {%
    draw,
    line width=1.4pt
  },
  Lottery/.style = {%
    draw,
    line width=1.4pt
  },
  Outcome/.style = {%
    circle,
    minimum width=3pt,
    fill,
    inner sep=0pt
  }
}
\usepackage{csquotes}
\usepackage{lipsum}
\usetikzlibrary{arrows.meta,automata,positioning} % to draw directed-weighted-graph


\usepackage{amsmath, amssymb, latexsym} % NN
\usepackage{tikz}% NN
\usetikzlibrary{decorations.pathreplacing}% NN
\usetikzlibrary{fadings}% NN


\usepackage{xltabular}
\usepackage{booktabs}

\usepackage[breakable, skins]{tcolorbox} % to add factual asepct inside a frame

\usepackage[title]{appendix}

%to prevent page and footnotes swalloen by the table


% == Checkmarks == 
\usepackage{bbding}
\usepackage{pifont}
\usepackage{wasysym}
\usepackage{amssymb}
% ================

% == BIBS ==
\usepackage{natbib}

\usepackage{diagbox}

\usepackage[bottom]{footmisc}

\usepackage[
  hidelinks,
  pdftex, 
  bookmarksopen=true, 
  bookmarksnumbered=true,
  pdfstartview=FitH, 
  breaklinks=true, 
  urlbordercolor={0 1 0}, 
  citebordercolor={0 0 1}]
  {hyperref}

\usepackage[ruled,vlined,linesnumbered]{algorithm2e}
\SetKwFor{For}{for (}{) $\lbrace$}{$\rbrace$}

%%% Coloring the comment as blue
\newcommand\mycommfont[1]{\footnotesize\ttfamily\textcolor{blue}{#1}}
\SetCommentSty{mycommfont}

\SetKwInput{KwInput}{Input}                % Set the Input
\SetKwInput{KwOutput}{Output}   
\usepackage{algpseudocode}% http://ctan.org/pkg/algorithmicx
\usepackage{varwidth}% http://ctan.org/pkg/varwidth


\usepackage{titlesec}

\setcounter{secnumdepth}{4}

\titleformat{\paragraph}
{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}


\bibliographystyle{apsr}

% == SPACES == 

% == CMMDS ==
\newcommand{\tit}{
\bf 
Mapping Jurisprudence of WTO Dispute Settlement Body Using Deep and Machine Learning
% Mapping Network of Articles of WTO Agreements Using Deep Learning
}
\newcommand\spacingset[1]{\renewcommand{\baselinestretch}
{#1}\small\normalsize}

% To draw embedding layer
\newcommand*{\xMin}{0}%
\newcommand*{\xMax}{6}%
\newcommand*{\yMin}{0}%
\newcommand*{\yMax}{9}%
% To draw conv output
\newcommand*{\xMinOut}{10}%
\newcommand*{\xMaxOut}{11}%
\newcommand*{\yMinOut}{1}%
\newcommand*{\yMaxOut}{8}%


% == VARS == 
\pgfmathsetmacro{\heatmap}{1}

% == START (PageCounter, Mode)
\begin{document}

\spacingset{1.25}

\setcounter{page}{0}
\vspace{-.1in}

% == TITLE (includes DraftDate)
{\title{
    \tit
  }
  \author{Suyeol Yun
  }
  \maketitle
}

\thispagestyle{empty}
\vspace{-.1in}

\begin{abstract}
  \input{abstract.tex}
\end{abstract}

\spacingset{1.5} % gives a slightly more margin between abstract and introduction

% \section{Tree of Contents}
% \input{forest.tex}
% \clearpage

% == INTRO ==
\section{Introduction}

\input{Introduction/how-wto-works.tex}
\input{Introduction/composite-characteristics.tex}
\input{Introduction/strategic-citation.tex}
\input{Introduction/motiviation.tex}
\input{Introduction/diffcult-to-map.tex}
\input{Introduction/solution/proxy-and-justification.tex}
\input{Introduction/methodology/neural-network-design.tex}
\input{Introduction/conclusion/assessment.tex}

% == DATA ==
% \clearpage
\section{Data: Types, Composition and Collection Process} \label{sec:data}
\input{Data/intro.tex}

\subsection{Overview: How Members Raise Claims in WTO DSB}
\input{Data/overview-wto-dsb.tex}

\subsection{Factual Aspect: Textual Description of the Dispute}
\input{Data/Factual Aspect/main.tex}

\subsection{Cited Articles: Set of Articles Cited for the Same Dispute}
\input{Data/Cited Articles/main.tex}

% == METHOD ==
\section{Methodology: Considerations and Development}
\input{Methodology/intro.tex}

\subsection{Two Main Considerations: Sufficient Information in Text \& Generalization} \label{justification-nn}
This paper considered two main points to
determine its method to qualitatively fit a set of edge weight $W$ for the \textit{directed weighted graph} $G$ defined in Figure \ref{fig:def}. 
One is importance of using the information inside the text of factual aspect and legal article as exemplified in \hyperref[sub:factual-aspect-example]{Appendix A.1} and Figure {\ref{fig:gatt_art1}} respectively. The other one is about the way to generalize each member's startegic citation pattern. Since members of the WTO strategically cite
the articles of WTO agreement expecting different outcomes that are fit to each member's specific interest \citep{who_gets, pelc, latent}, this paper
selected a method that can generalize these member speicific citation patterns. These two considerations and the solution will be explained in the following subsections.
\input{Methodology/Figures/spare_dense.tex}

\subsubsection{Importance of Using Textual Information}
\input{Methodology/Importance-of-Textual-Information/why-it-fails.tex}

\subsubsection{Generalization of Each Member's Strategic Citation}

This paper aims to map the regulatory system of WTO DSB in a form of \textit{directed weighted graph} $G$ as defined in Figure \ref{fig:def}.
To achieve this purpose, we need to fit $W$ to generalize member specific strategic citation behavior.
In terms of generalization, deep neural network is known to generalize well despite
its large capacity \citep{neyshabur2017exploring}, possible instability of training algorithm \citep{charles2017stability}, nonrobustness \citep{zahavy2017ensemble}, and sharp minima \citep{dinh2017sharp}.
Therefore this paper trains a deep neural network without any member specific information such as geolocation, GDP or specialized industry and so on that can refer to the member's trade related interest. 
By training a deep neural network only using a description of the possible inconsistent trade policy and the legal text of the cited articles,
this paper expects a fitted $G^{*} = (V, E, W^*)$ can show interactions between articles of the WTO agreements
without being biased to member specific trade interest and its strategic citation upon it.

\subsection{Design of Deep Neural Network}\label{subsec:design:dnn}
Upon the justification of using deep neural network with above two main considerations in Section \ref{justification-nn}, %one is to effectively process the text information and the other one is to generalize member specific strategic citation,
I explain a design process of deep neural network that can encode the citation patterns in WTO DSB. 
This paper understands that those citations are performed upon the general understanding over jurisprudences of WTO DSB and encoding of 
those citation pattern could reveal the jurisprudences of WTO DSB.


\input{Methodology/design-of-neural-network/visualize-how-member-cites/citable.tex}
\input{Methodology/design-of-neural-network/visualize-how-member-cites/non-citable.tex}
\input{Methodology/design-of-neural-network/design-of-nn.tex}
\input{Methodology/design-of-neural-network/fm-def-nn.tex}

\subsubsection{Design Input/Output of Deep Neural Network: by Analogy with How Member Cites in WTO DSB} \label{design:io}
A rule of thumb to design input and output of deep neural network is to mimic
how humans do for a given task.
Therefore I present a visualization of how legal experts of WTO agreements determine whether to cite a legal article of WTO agreements with an example of \textit{Korea - Beef} case (Figure \ref{fig:viz:how-member-cites-citable} and Figure \ref{fig:viz:how-member-cites-non-citable}).
In this case, the United States raised a claim relating to the \textit{Dual-retail system} maintained by South Korea. In \textit{Dual-retail system}, South Korea maintained two distinct retail systems
for imported and domestic beef, i.e., there exist stores specialized for imported beef and they can sell only imported beef and cannot sell domestic (Korean) beef. U.S. claimed that the \textit{Dual-retail system} is inconsistent to the Article III:4 (National Treatment) of GATT 1994
because \textit{Dual-retail system} discriminates domestic and imported beef. A measure that discriminates domestic and imported products falls under the scope of the Article III:4 of the GATT 1994, which states the principle of \textit{National Treatment} that prohibits the discrimination between imported and domestic \textit{like product}. However, U.S. didn't
cite the Article I:1 of GATT 1994 that prohibits the discrimination between members of WTO
because \textit{Dual-retail system} didn't discriminate the United States from other countries that exports beef to South Korea, such as Argentina, Austrailia, etc.

We can understand that there exists a shared understanding over jurisprudences of WTO DSB among legal experts of the rules of WTO. They follow up new cases and study jurisprudence stated in the \textit{Panel} or  \textit{Appellate Body} reports.
Then they organize a legal argument by citing certain article(s) upon this shared understanding for given possible inconsistent measure claimed by a member of WTO.

To mimic this reasoning process, I designed the input and output of the deep neural network as illustrated in Figure \ref{fig:design-of-nn} and formally defined in Figure \ref{fig:def:io:nn}.
The neural network is designed to estimate the citability for given pair of a factual aspect and text of a legal article.
By iteratively training the neural network with data explained in Section \ref{sec:data}, I expect the neural network can learn a shared understanding over reglatory system of WTO DSB as closely to that of legal experts.
The detailed structure of neural network and training schemes will be explained in the later subsections.
% For total $11,440$ pairs of factual aspect and legal articles (143 different cases (Figure \ref{fig:ds-cases-used}) and 80 different legal articles (Figure \ref{fig:def:set-of-cited-articles})
\clearpage
\input{Methodology/dnn-flow-chart.tex}

\subsubsection{Structure of Deep Neural Network}


An efficient way to architect the structure of deep neural network is to use the
human analogy as I did in subsection \ref{design:io}.
A legal expert reads the text line by line and creates several local understandings.
Then he/she merges those local understandings into a global level to summarize
an essential information to deterimine whether
the given article is citable or not for the given factual description of the dispute.

To analogy this process, I borrowed \textit{1-Dimensional Text Convolutional Neural Network} (TextCNN) from \cite{textcnn}.
This is because of the following two reasons.
First, convolutional neural network is known as good at learning how to integrate local and global features to perform classification task \citep{554195, 8227460}.
Second, \cite{textcnn} has implemented this convolutional neural network into the text domain
and has shown its high performance on classification.

\paragraph{Test Modified Paragraph}


I explained technical Details of each layer illustrated in Figure \ref{fig:dnn-flow} in Appendix.


\subsubsection{Train of Deep Neural Network}
% \textbf{Split of Train/Test Data} 
I have total 11,440 number of data instances that is calculated by $|D| * |V|$ where $|D| = 143$ and $|V|=80$.
Before training, I randomly split the entire dataset $T \times A$ into train and test data in 8:2 ratio.
The number of split result is 9,153 for train data and 2,287 for test data.
I used train data only to train the neural network and used test data to check the trained model's performance.
By measuring a selected performance
metric on the inference results of the test data, one can check the generalizability of the trained neural network regarding
how well the trained neural network can perform over the data that it has never seen before.

The term ``training" refers to fitting a set of parameters $\theta$,
that constitutes mathematical operations defined in layers illustrated in Figure \ref{fig:dnn-flow}.
The procedure to fit those set of parameters is as described in Algorithm \ref{algo:fit-dnn}.

\input{Methodology/train-algo.tex}

I fitted the nerual network $f_\theta$ using \textit{weighted cross entropy loss} as explained in Algorithm \ref{algo:fit-dnn}.
I used \textit{cross entropy loss} because it measures how much the probability distribution $\hat{Y}$ projected by the trained model $f_\theta$
deviates from the true distribution $Y$ which symbolically represents a shared understanding regarding the citability of certain legal article for given textual description of the case
among the group of legal experts of WTO agreements.

It's worth noting that I ``weighted" \textit{cross entropy loss}. This is because
our dataset is highly imbalanced in terms of citability.
%represents the number of factual aspects and $|V|=80$ represents the number of legal articles.  
Among all (11,440) data instances, I have only 435 data instances where the given article $a_v$ is actually cited for the case description $t_d$. This is only 3.802\%.
This is because a case tends to have only 3 - 4 articles cited on average among 80 different articles in $V$.
Therefore, I adopted a weight of 26.303, which is inverse of the $3.802\%$ to penalize the neural network with higher loss in case the network fails to cite correctly for the positive case where $y \gets 1$ in Algorithm \ref{algo:fit-dnn}.

More techinical details regarding epochs and learning rates will be covered in Appendix. and the training result (model performance) will be explained in Appendix.

% Epochs and learning rate are hyperparameters whose value shall be given by the experimenter. Epochs $e$ is about how many times the neural network will train the entire train dataset and learning rate $\alpha$ is about how much update the model parameter for each step. 
% More technical details about 

% \subsection{Reconstruction of Network of Articles of WTO Agreements}
\subsection{Fitting $G^* = (V, E, W^*)$ using Random Forests}
This subsection explains how I found the best set of directed edge weights $W^*$ that closely maps the shared understanding of legal experts in a form of \textit{directed weighted graph} as defined in Figure \ref{fig:def} and illustrated in Figure \ref{fig:def-example} using the trained neural network $f_{\theta^*}$.

\subsubsection{Definition of $W^*$: Best Set of Directed Edge Weights} %for the Network of Legal Articles of the WTO agreements}
\input{Methodology/RF/fitting.tex}
\subsubsection{Random Forest on Prediction Matrix $P$: Finding $W^*$} %for the Network of Legal Articles of the WTO agreements}
\input{Methodology/RF/explains.tex}
\input{Methodology/RF/algorithm.tex}

\section{Empirical Findings}\label{ef} %: Quality Check of the Fitted Network $G^*$}
\input{Empirical Findings/intro.tex}

\subsection{\textit{Market Access}: Ensuring Foreign Goods to Cross Borders and Fairly Compete with Domestic Products}\label{emp:ma}
% \subsubsection{Main Articles of \textit{Market Access}}

\input{Empirical Findings/market-access.tex}

% \subsubsection{Fine Scoped Interpretation of \textit{Market Access} Network}

\subsection{\textit{Reciprocity} in Non-Tariff Barriers: Compensate or Retaliate as Much as You have Protected}
% \subsection{\textit{Non-Tariff Barriers}: Anti-dumping, Countervailing Duties and Safeguard}
\input{Empirical Findings/non-tariff-barrier.tex}


\subsection{\textit{Non-discrimination} Principle for Formulating Regional Trade Agreements (RTA)}  %: Non-discrimination, Transparency and Compensatory Adjustment}

\begin{figure}[ht]
  \centering{
    \input{Empirical Findings/rta-graph.tex}
  }
  \caption{{\bf Network of Articles that Achieves \textit{Non-discrimination} for Formulating \textit{RTAs}:}
    A rudimentary obligation of Article XXIV that prohibits discrimination between non-RTA and RTA members become realized in a relationship with
    different types of trade measures, such as \textit{Safeguard} or \textit{Quantitative Restriction}.
    % As members are deviating from their obligation under Article XXIV with different types of trade policy, it leads to the multiple disputes and 
    % it formulates a directive edge weights as shown in the Figure.
  }
  \label{fig:rta-explained}
\end{figure}

% \subsubsection{Non-discriminatory Principle for Formulating RTAs}
\input{Empirical Findings/rtas.tex}

% \subsubsection{\textit{Due dilligence Consultation} for Formulating RTAs}



% \subsection{Market Access}
% \input{Empirical Findings/market-access.tex}

% \subsubsection{Market Access Principle Captured in a Reconstructed Network}
% \input{Empirical Findings/market-access-network.tex}

\section{Conclusion}
\input{conclusion.tex}
\clearpage
% This paper shows how WTO works.

% \begin{itemize}
%   \item Implicaiton of thie method in general.
%   \item Address the imbalance of legal capacity between developed/ing countries
% \end{itemize}

% \subsubsection{Embedding Layer}
\input{Methodology/embedding.tex}

% \subsubsection{1-Dimensional Convolution Layer (Conv1D)}
\input{Methodology/Conv1D.tex}

% \subsubsection{1-Dimensional Max-pooling (MaxPool1D)}
\input{Methodology/MaxPool1D.tex}


\clearpage \bibliography{bibtemplate}

\clearpage
\begin{appendices}
  \section{}
  \label{sec:appendix}
  % \subsection{Table of Contents of the Panel Report}
  % \input{Data/examples/table-of-content-panel.tex}


  \subsection{Factual Aspect Example}
  \label{sub:factual-aspect-example}
  \input{Data/examples/factual-aspect.tex}

  % \subsection{Content of Legal Article Example}


  \subsection{Collected Cited Articles for 143 WTO DSB Cases}
  DS refers to \textit{Dispute Settelement} and this notation is officially adopted by WTO DSB.\\
  WTO DSB identifies each dispute with a unique number for each case such as DS2 and DS18.
  \label{sub:cited-articles-table}
  \input{Data/examples/cited-articles-table.tex}

  \subsection{Technical Details}
  \label{sub:technicial-details}

  \input{Figures/heatmap.tex}

  % \input{coo.tex}
\end{appendices}
\end{document}